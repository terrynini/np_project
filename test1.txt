   1    1 CC = g++
   2    2 CFLAG = -std=c++11
   3    3 INCS = -I./include
   4    4 BUILDDIR = build
   5    5 SRCDIRS = src
   6    6 SRCS = $(shell find $(SRCDIRS) -name '*.cpp')
   7    7 PROJECTS = np_simple np_single_proc np_multi_proc 
   8    8 PROJECT = $(foreach project, $(PROJECTS), $(BUILDDIR)/$(project))
   9    9 OBJS = $(patsubst $(SRCDIRS)/%.cpp, $(BUILDDIR)/%.o,$(SRCS))
  10   10 COBJS = $(filter-out $(foreach project, $(PROJECTS), $(BUILDDIR)/$(project).o) , $(OBJS))
  11   11 
  12   12 ##.SECONDEXPANSION:
  13   13 all: $(PROJECT)
  14   14 
  15   15 $(PROJECT): $(BUILDDIR) $(OBJS) # | $$(dir $$@)
  16   16 	$(CC) $(CFLAG) $(COBJS) $@.o $(INCS) -o $@
  17   17 	mv $@ ./
  18   18 	
  19   19 $(BUILDDIR)/%.o: $(SRCDIRS)/%.cpp 
  20   20 	$(CC) $(CFLAG) -c $< $(INCS) -o $@
  21   21 
  22   22 $(BUILDDIR):
  23   23 	mkdir -p $(BUILDDIR)
  24   24 .PRECIOUS : $(BUILDDIR)
  25   25 
  26   26 .PHONY: clean
  27   27 clean:
  28   28 	rm -r $(BUILDDIR)/*	
